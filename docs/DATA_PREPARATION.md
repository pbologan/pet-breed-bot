# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö

## –û–±–∑–æ—Ä

–°–∫—Ä–∏–ø—Ç `prepare_data.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –≥–æ—Ç–æ–≤—É—é –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

1. **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** - –°–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É train/val —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º
2. **–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã –º–µ—Ç–æ–∫** - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JSON —Ñ–∞–π–ª —Å –º–∞–ø–ø–∏–Ω–≥–æ–º –∫–ª–∞—Å—Å–æ–≤
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç –∏ —Å–æ–∑–¥–∞—ë—Ç –æ—Ç—á—ë—Ç
4. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã

### 1. Oxford-IIIT Pet Dataset

- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: `oxford-pets/images/Breed_name_123.jpg`
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: –ü–∞—Ä—Å–∏—Ç –∏–º—è –ø–æ—Ä–æ–¥—ã –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
- **–ö–ª–∞—Å—Å—ã**: 37 –ø–æ—Ä–æ–¥ (25 —Å–æ–±–∞–∫ + 12 –∫–æ—à–µ–∫)

### 2. Stanford Dogs Dataset

- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: `stanford-dogs/Images/n02085620-Chihuahua/*.jpg`
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: –£–¥–∞–ª—è–µ—Ç ImageNet ID, –æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Ä–æ–¥—ã
- **–ö–ª–∞—Å—Å—ã**: 120 –ø–æ—Ä–æ–¥ —Å–æ–±–∞–∫

### 3. CUB-200-2011 Birds Dataset

- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: `cub-200-2011/CUB_200_2011/images/001.Black_footed_Albatross/*.jpg`
- **–û–±—Ä–∞–±–æ—Ç–∫–∞**: –£–¥–∞–ª—è–µ—Ç —á–∏—Å–ª–æ–≤–æ–π –ø—Ä–µ—Ñ–∏–∫—Å, —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ
- **–ö–ª–∞—Å—Å—ã**: 200 –≤–∏–¥–æ–≤ –ø—Ç–∏—Ü

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
# –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞—Ç–∞—Å–µ—Ç—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
python scripts/prepare_data.py
```

### –° —Å–æ–∑–¥–∞–Ω–∏–µ–º –∫–∞—Ä—Ç—ã –º–µ—Ç–æ–∫

```bash
# –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ–∑–¥–∞—Ç—å label_map.json
python scripts/prepare_data.py --create-label-map
```

### –° –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```bash
# –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ —Å–æ–∑–¥–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
python scripts/prepare_data.py --stats
```

### –ü–æ–ª–Ω—ã–π pipeline

```bash
# –í—Å—ë —Å—Ä–∞–∑—É: –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è + –º–µ—Ç–∫–∏ + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
python scripts/prepare_data.py --create-label-map --stats
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```bash
# –ò–∑–º–µ–Ω–∏—Ç—å —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ train/val (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 80/20)
python scripts/prepare_data.py --train-split 0.85 --create-label-map

# –£–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
python scripts/prepare_data.py \
  --input-dir /path/to/raw \
  --output-dir /path/to/processed \
  --create-label-map --stats
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä             | –¢–∏–ø    | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é     | –û–ø–∏—Å–∞–Ω–∏–µ                             |
| -------------------- | ------ | ---------------- | ------------------------------------ |
| `--input-dir`        | Path   | `data/raw`       | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏ |
| `--output-dir`       | Path   | `data/processed` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö   |
| `--train-split`      | Float  | `0.8`            | –î–æ–ª—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (0.0-1.0)   |
| `--create-label-map` | Flag   | `False`          | –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å –º–∞–ø–ø–∏–Ω–≥–æ–º –∫–ª–∞—Å—Å–æ–≤     |
| `--stats`            | Flag   | `False`          | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–∞—Ç–∞—Å–µ—Ç–∞    |
| `--dataset`          | Choice | `all`            | –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏     |

## –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
data/processed/
‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îú‚îÄ‚îÄ Abyssinian/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Abyssinian_1.jpg
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Abyssinian_2.jpg
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ American_Bulldog/
‚îÇ   ‚îú‚îÄ‚îÄ Beagle/
‚îÇ   ‚îî‚îÄ‚îÄ ... (–≤—Å–µ –∫–ª–∞—Å—Å—ã)
‚îú‚îÄ‚îÄ val/
‚îÇ   ‚îú‚îÄ‚îÄ Abyssinian/
‚îÇ   ‚îú‚îÄ‚îÄ American_Bulldog/
‚îÇ   ‚îî‚îÄ‚îÄ ... (–≤—Å–µ –∫–ª–∞—Å—Å—ã)
‚îî‚îÄ‚îÄ dataset_statistics.json
```

## –ö–∞—Ä—Ç–∞ –º–µ—Ç–æ–∫ (Label Map)

–°–æ–∑–¥–∞—ë—Ç—Å—è —Ñ–∞–π–ª `models/label_map.json`:

```json
{
  "idx_to_label": {
    "0": "Abyssinian",
    "1": "American Bulldog",
    "2": "Beagle",
    ...
  },
  "label_to_idx": {
    "Abyssinian": 0,
    "American Bulldog": 1,
    "Beagle": 2,
    ...
  }
}
```

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

### –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

1. **–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**

   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (train/val/total)
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤
   - –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ train/val

2. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤**

   - Min/Max/Avg –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –∫–ª–∞—Å—Å
   - Top 10 –∫–ª–∞—Å—Å–æ–≤ (—Å–∞–º—ã–µ –±–æ–ª—å—à–∏–µ)
   - Bottom 10 –∫–ª–∞—Å—Å–æ–≤ (—Å–∞–º—ã–µ –º–∞–ª–µ–Ω—å–∫–∏–µ)

3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**

   - –†–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—à–∏—Ä–∏–Ω–∞/–≤—ã—Å–æ—Ç–∞)
   - Min/Max/Avg —Ä–∞–∑–º–µ—Ä—ã

4. **–í–∞–ª–∏–¥–∞—Ü–∏—è**
   - –°–ø–∏—Å–æ–∫ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–µ—Å–ª–∏ –µ—Å—Ç—å)

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
============================================================
DATASET STATISTICS
============================================================

üìä Overall Statistics:
  Training images: 5,880
  Validation images: 1,470
  Total images: 7,350
  Number of classes: 37
  Train/Val split: 80.0% / 20.0%

üìà Class Distribution:
  Training images per class:
    Min: 120, Max: 200, Avg: 158.9

üîù Top 10 Classes (by training images):
   1. Abyssinian                    - Train:  160, Val:   40
   2. American Bulldog              - Train:  159, Val:   40
   ...

üñºÔ∏è  Image Size Statistics (sampled):
  Width:  Min:  200, Max: 1024, Avg: 500
  Height: Min:  200, Max: 1024, Avg: 450

‚úì No corrupted images found
```

### –§–∞–π–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `data/processed/dataset_statistics.json`:

```json
{
  "total_train": 5880,
  "total_val": 1470,
  "num_classes": 37,
  "train_classes": {
    "Abyssinian": 160,
    "American_Bulldog": 159,
    ...
  },
  "val_classes": {
    "Abyssinian": 40,
    "American_Bulldog": 40,
    ...
  },
  "corrupted_images": []
}
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –£–º–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞** –∫–∞–∂–¥–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
- **–ü–∞—Ä—Å–∏–Ω–≥ –∏–º—ë–Ω –∫–ª–∞—Å—Å–æ–≤** –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π** (–∑–∞–º–µ–Ω–∞ underscore –Ω–∞ –ø—Ä–æ–±–µ–ª—ã)
- **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** (random_state=42)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

- **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è** –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è** –ø–µ—Ä–µ–¥ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º (skip duplicates)
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** —á–µ—Ä–µ–∑ PIL.Image.verify()

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã** –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (tqdm)
- **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –∫–ª–∞—Å—Å–æ–≤
- **–í—ã–±–æ—Ä–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–µ—Ä–≤—ã–µ 10 –Ω–∞ –∫–ª–∞—Å—Å)

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "Input directory not found"

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞—Ç–∞—Å–µ—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã
python scripts/download_datasets.py --dataset all

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
ls -la data/raw/
```

### –û—à–∏–±–∫–∞: "Train directory is empty"

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
ls -la data/raw/oxford-pets/
ls -la data/raw/stanford-dogs/

# –í–æ–∑–º–æ–∂–Ω–æ, –¥–∞—Ç–∞—Å–µ—Ç—ã –Ω–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω—ã
python scripts/download_datasets.py --dataset oxford-pets
```

### –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: "Found corrupted images"

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –≤ dataset_statistics.json
cat data/processed/dataset_statistics.json | grep corrupted

# –£–¥–∞–ª–∏—Ç–µ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É
python scripts/prepare_data.py --create-label-map --stats
```

### –û—à–∏–±–∫–∞: "No recognized datasets found"

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞—Ç–∞—Å–µ—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ:
# data/raw/oxford-pets/
# data/raw/stanford-dogs/
# data/raw/cub-200-2011/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º–µ–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
ls -la data/raw/
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö

1. –ù–∞—á–Ω–∏—Ç–µ —Å –æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ (Oxford-IIIT)
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (train_split=0.8)
3. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
python scripts/download_datasets.py --dataset oxford-pets
python scripts/prepare_data.py --create-label-map --stats
```

### –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö

1. –ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ train/val split –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã
3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤

```bash
# –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –¥–∞—Ç–∞—Å–µ—Ç—ã
python scripts/download_datasets.py --dataset all

# –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º validation set
python scripts/prepare_data.py --train-split 0.75 --create-label-map --stats

# –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
cat data/processed/dataset_statistics.json
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞

1. **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤**: –ï—Å–ª–∏ –∫–ª–∞—Å—Å—ã —Å–∏–ª—å–Ω–æ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

   - Weighted sampling –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
   - Data augmentation –¥–ª—è –º–∞–ª—ã—Ö –∫–ª–∞—Å—Å–æ–≤
   - Class weights –≤ loss function

2. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –î–ª—è –º–∞–ª—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤:

   - –£–º–µ–Ω—å—à–∏—Ç–µ train_split –¥–æ 0.7 –¥–ª—è –±–æ–ª—å—à–µ–≥–æ validation set
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—É—é –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—é

3. **–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: –ü–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ dataset_statistics.json
   - –£–¥–∞–ª–∏—Ç–µ corrupted images
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª–∞—Å—Å—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ–±—É—á–µ–Ω–∏–µ–º

–ü–æ—Å–ª–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
ls -la data/processed/train/ | head -20

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—Ä—Ç—É –º–µ—Ç–æ–∫
cat models/label_map.json | head -30

# 3. –ù–∞—á–Ω–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ
python -m app.ml.train \
  --data-dir data/processed \
  --epochs 10 \
  --batch-size 32 \
  --lr 0.001
```

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–°–æ–∑–¥–∞–π—Ç–µ bash —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ pipeline:

```bash
#!/bin/bash
# prepare_and_train.sh

set -e

echo "Step 1: Downloading datasets..."
python scripts/download_datasets.py --dataset all

echo "Step 2: Preparing data..."
python scripts/prepare_data.py --create-label-map --stats

echo "Step 3: Training model..."
python -m app.ml.train --data-dir data/processed --epochs 20

echo "Step 4: Evaluating model..."
python -m app.ml.eval --data-dir data/processed/val

echo "Done!"
```
